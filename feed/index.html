<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pepsval â€” Feed</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="/feed/feed.css?v=8001" />

  <script type="module" src="/js/supabase.js"></script>
  <script type="module" src="/js/guard.js"></script>
  <script type="module" src="/feed/feed.js?v=8001"></script>
</head>

<body class="app-bg">

  <header class="topbar">
    <div class="topbar-left">
      <img src="/assets/logo.webp" class="top-logo" alt="Pepsval"/>
      <span class="brand">Pepsval</span>
    </div>

    <div class="topbar-right">
      <span id="userName" class="user-name">Loadingâ€¦</span>

      <button id="avatarBtn" class="avatarBtn" aria-label="Account menu">
        <img id="userAvatar" class="avatar" alt="Me"/>
      </button>

      <div id="avatarMenu" class="avatarMenu" hidden>
        <a href="/profile/home.html" class="menuItem">My profile</a>
        <a href="/dashboard/settings.html" class="menuItem">Settings</a>
        <button id="logoutBtn" class="menuItem danger" type="button">Logout</button>
      </div>
    </div>
  </header>

  <main class="feed-wrap">
    <div class="create-post">
      <textarea id="postText" placeholder="Share something with seafarersâ€¦"></textarea>

      <div class="post-actions">
        <!-- IMPORTANT: do NOT use hidden attribute -->
        <input type="file" id="postMedia" class="fileInput" accept="image/*,video/*" />

        <!-- Label triggers the file picker reliably on mobile -->
        <label id="addMedia" class="btn" for="postMedia">ðŸ“· Photo / ðŸŽ¥ Video</label>

        <button id="postBtn" class="primary" type="button">Post</button>
      </div>

      <div id="uploadStatus" class="uploadStatus" hidden>
        <div class="uploadRow">
          <progress id="uploadBar" max="100" value="0"></progress>
          <span id="uploadPct" class="uploadPct">0%</span>
        </div>
      </div>

      <div id="mediaPreview"></div>
    </div>

    <div id="feedList" class="feed-list">
      <div class="loading">Loading feedâ€¦</div>
    </div>
  </main>

  <nav class="bottom-nav">
    <a class="nav-item active" href="/feed/index.html">Feed</a>
    <a class="nav-item" href="/jobs/index.html">Jobs</a>
    <a class="nav-item" href="/messages/index.html">Messages</a>
    <a class="nav-item" href="/profile/home.html">Profile</a>
  </nav>

</body>
</html>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PEPSVAL — Profile</title>

  <link rel="stylesheet" href="/css/style.css?v=4201" />
  <link rel="stylesheet" href="/profile/profile.css?v=4201" />

  <style>
    /* Minimal safety styles for modal if your profile.css doesn't include it yet */
    .hidden{display:none !important}

    .modalBack{
      position:fixed; inset:0; display:none;
      background:rgba(0,0,0,.45);
      z-index:9999;
      align-items:center; justify-content:center;
      padding:16px;
    }
    .modalBack.show{display:flex}

    .modal{
      width:min(520px, 96vw);
      background:#fff;
      border-radius:16px;
      padding:14px;
      box-shadow: 0 20px 70px rgba(0,0,0,.35);
    }
    .modalHead{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-bottom:10px;
    }
    .modalTitle{font-weight:700}
    .modalRow{margin-top:10px}
    .range{width:100%}

    /* Avatar clickable */
    .avatarBtn{
      border:0; background:transparent; padding:0; cursor:pointer;
      border-radius:999px;
    }
    .avatarShell{
      width:66px; height:66px; border-radius:999px;
      border:2px solid rgba(31,111,134,.25);
      background:#eef6fb;
      overflow:hidden;
      display:flex; align-items:center; justify-content:center;
    }
    .avatarShell img{width:100%; height:100%; object-fit:cover}
    .avatarFallback{
      font-weight:800; color:#1F6F86; font-size:22px;
    }

    /* About editable blocks (contentEditable) */
    .v[contenteditable="true"]{outline: none;}
    textarea{font-family:inherit;}
    input{font-family:inherit;}
  </style>
</head>

<body>
  <header class="topbar">
    <a class="brand" href="/feed/index.html" aria-label="Go to feed">
      <div class="brandWord">PEPSVAL</div>
      <div class="brandTag">connect, hire and grow</div>
    </a>

    <a class="btnGhost" href="/feed/index.html">Back</a>
  </header>

  <main class="wrap">
    <section class="profileCard">

      <!-- TOP HEADER -->
      <div class="profileTop">
        <div class="avatarWrap">
          <!-- CLICKABLE AVATAR -->
          <button id="avatarBtn" class="avatarBtn" type="button" aria-label="Change profile photo">
            <div class="avatarShell">
              <img id="avatarImg" class="hidden" alt="Profile photo" />
              <div id="avatarFallback" class="avatarFallback">P</div>
            </div>
          </button>

          <!-- Hidden file input -->
          <input id="avatarFile" class="hidden" type="file" accept="image/*" />
        </div>

        <div class="headerText">
          <div class="nameRow">
            <div class="name" id="profileName">Profile</div>
            <span id="typeBadge" class="badge">—</span>
          </div>

          <div class="miniRow">
            <div class="miniItem"><span id="miniTitleLabel">Title</span>: <span id="miniTitle">—</span></div>
            <div class="miniItem">Nationality: <span id="miniNationality">—</span></div>
          </div>
        </div>
      </div>

      <!-- TABS -->
      <div class="tabs">
        <button class="tab active" data-tab="about" type="button">About</button>
        <button class="tab" data-tab="posts" type="button">Posts</button>

        <!-- Seafarer only -->
        <button id="tabDocumentsBtn" class="tab" data-tab="documents" type="button">Documents</button>

        <!-- Company / Professional only -->
        <button id="tabExperienceBtn" class="tab" data-tab="experience" type="button">Experience</button>

        <!-- Seafarer only -->
        <button id="tabSeaBtn" class="tab" data-tab="sea" type="button">Sea Service</button>
      </div>

      <!-- ABOUT -->
      <section id="tab_about" class="pane">
        <div class="paneTitle" id="aboutTitle">Profile</div>

        <div class="btnRow">
          <button id="editAboutBtn" class="btnGhost" type="button">Edit</button>
          <button id="saveAboutBtn" class="btnPrimary hidden" type="button">Save</button>
        </div>

        <div class="aboutGrid">
          <div class="box">
            <div class="k">Full Name</div>
            <div class="v" id="fullName">—</div>
          </div>

          <div class="box">
            <div class="k">Email</div>
            <div class="v" id="email">—</div>
          </div>

          <div class="box">
            <div class="k" id="titleLabel">Title</div>
            <div class="v" id="titleValue">—</div>
          </div>

          <div class="box">
            <div class="k">Nationality</div>
            <div class="v" id="nationality">—</div>
          </div>

          <div class="box span2">
            <div class="k">Bio</div>
            <div class="v bioText" id="bio">—</div>
          </div>
        </div>

        <!-- Seafarer rank dropdown (only appears when editing + role=seafarer) -->
        <div id="rankEditWrap" class="field hidden" style="margin-top:14px;">
          <label class="lbl">Ship role <span class="req">*</span></label>

          <div class="combo" data-combo="rank">
            <input id="rankSearch" type="text" placeholder="Search ship role…" autocomplete="off" />
            <input id="rankValue" type="hidden" />
            <div class="comboList" id="rankList"></div>
          </div>

          <div class="field hidden" id="rankOtherWrap" style="margin-top:10px;">
            <label class="lbl">Other role</label>
            <input id="rankOther" type="text" placeholder="Write your ship role" />
          </div>
          <div class="help">Choose from ship roles. If not found, choose Other and type.</div>
        </div>
      </section>

      <!-- POSTS -->
      <section id="tab_posts" class="pane hidden">
        <div class="paneTitle">Posts</div>
        <div class="muted">Coming next: your posts list.</div>
      </section>

      <!-- DOCUMENTS (Seafarer) -->
      <section id="tab_documents" class="pane hidden">
        <div class="paneTitle">Documents</div>
        <div class="muted">Coming next: document upload + verification.</div>
      </section>

      <!-- EXPERIENCE (Company/Professional) -->
      <section id="tab_experience" class="pane hidden">
        <div class="paneTitle" id="expTitle">Experience</div>

        <div class="btnRow">
          <button id="editExpBtn" class="btnGhost" type="button">Edit</button>
          <button id="saveExpBtn" class="btnPrimary hidden" type="button">Save</button>
        </div>

        <!-- Professional -->
        <div id="proExpWrap" class="hidden">
          <div class="box span2">
            <div class="k">Summary (service years, specialization)</div>
            <textarea id="proSummary" rows="3" style="width:100%;resize:vertical" placeholder="Example: 8 years in bulk carriers / tanker operations, cargo & stability..."></textarea>
          </div>

          <div class="box span2">
            <div class="k">Services (one per line)</div>
            <textarea id="proServices" rows="4" style="width:100%;resize:vertical" placeholder="Example:
• Marine surveying
• Vetting support
• Training & audits"></textarea>
          </div>

          <div class="box span2">
            <div class="k">Achievements (one per line)</div>
            <textarea id="proAchievements" rows="4" style="width:100%;resize:vertical" placeholder="Example:
• Led 50+ inspections
• Reduced incidents by 30%"></textarea>
          </div>

          <div class="paneTitle" style="margin-top:14px;">Companies / Roles (LinkedIn style)</div>
          <button id="addExpBtn" class="btnGhost" type="button">+ Add Experience</button>
          <div id="expList" style="margin-top:10px;"></div>
        </div>

        <!-- Company -->
        <div id="companyWrap" class="hidden">
          <div class="box span2">
            <div class="k">What the company is</div>
            <textarea id="coWhat" rows="3" style="width:100%;resize:vertical" placeholder="What you do, who you serve, what sector..."></textarea>
          </div>

          <div class="box span2">
            <div class="k">Mission</div>
            <textarea id="coMission" rows="3" style="width:100%;resize:vertical" placeholder="Mission statement"></textarea>
          </div>

          <div class="box span2">
            <div class="k">Vision</div>
            <textarea id="coVision" rows="3" style="width:100%;resize:vertical" placeholder="Vision statement"></textarea>
          </div>

          <div class="box span2">
            <div class="k">Core values</div>
            <textarea id="coValues" rows="3" style="width:100%;resize:vertical" placeholder="Safety, quality, trust, innovation..."></textarea>
          </div>

          <div class="box">
            <div class="k">Total workers</div>
            <input id="coWorkers" type="number" min="0" placeholder="e.g., 120" style="width:100%;" />
          </div>

          <div class="box span2">
            <div class="k">Services (one per line)</div>
            <textarea id="coServices" rows="4" style="width:100%;resize:vertical" placeholder="Crew management
Training
Ship management"></textarea>
          </div>

          <div class="box span2">
            <div class="k">Achievements (one per line)</div>
            <textarea id="coAchievements" rows="4" style="width:100%;resize:vertical" placeholder="ISO certified
500+ seafarers placed
Awarded best employer..."></textarea>
          </div>
        </div>
      </section>

      <!-- SEA SERVICE (Seafarer) -->
      <section id="tab_sea" class="pane hidden">
        <div class="paneTitle">Sea Service</div>
        <div class="muted">Coming next: add sea service entries + peer verification.</div>
      </section>

    </section>
  </main>

  <!-- CROP MODAL -->
  <div id="cropBack" class="modalBack" aria-hidden="true">
    <div class="modal">
      <div class="modalHead">
        <div class="modalTitle">Adjust profile photo</div>
        <button id="cropClose" class="btnGhost" type="button">✕</button>
      </div>

      <div class="modalRow">
        <canvas id="cropCanvas" width="360" height="360" style="width:100%; border-radius:14px; background:#f1f6fb;"></canvas>
      </div>

      <div class="modalRow">
        <div class="muted" style="margin-bottom:6px;">Zoom</div>
        <input id="zoomRange" class="range" type="range" min="1" max="3" step="0.01" value="1.4" />
        <div class="muted" style="margin-top:6px;">Drag the image to position.</div>
      </div>

      <!-- Filters UI is injected by JS automatically (Brightness/Contrast/Saturation + presets) -->

      <div class="modalRow" style="display:flex;gap:10px;justify-content:flex-end;flex-wrap:wrap;">
        <button id="cropCancel" class="btnGhost" type="button">Cancel</button>
        <button id="cropSave" class="btnPrimary" type="button">Save Photo</button>
      </div>
    </div>
  </div>

  <script type="module" src="/profile/profile.js?v=4201"></script>
</body>
</html>
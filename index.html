<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pepsval ‚Äî Where Shipping Trust Exists</title>

  <link rel="icon" type="image/webp" href="logo.webp" />
  <link rel="apple-touch-icon" href="logo.webp" />

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --bg0:#050714; --bg1:#0b1030;
      --card:rgba(255,255,255,.08); --stroke:rgba(255,255,255,.14);
      --text:#f4f7ff; --muted:rgba(244,247,255,.72);
      --shadow: 0 30px 90px rgba(0,0,0,.45);
      --a:#7c3aed; --b:#22d3ee; --c:#ff5ad6;
      --ok:#22c55e; --warn:#f59e0b; --err:#ef4444;
      --r:22px;
    }
    [data-theme="light"]{
      --bg0:#f7f8ff; --bg1:#eef1ff;
      --card:rgba(0,0,0,.05); --stroke:rgba(0,0,0,.10);
      --text:#0b1022; --muted:rgba(11,16,34,.70);
      --shadow: 0 24px 70px rgba(0,0,0,.16);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(124,58,237,.35), transparent 55%),
        radial-gradient(900px 700px at 85% 18%, rgba(34,211,238,.22), transparent 55%),
        radial-gradient(800px 900px at 55% 95%, rgba(255,90,214,.18), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }
    .wrap{max-width:1100px;margin:0 auto;padding:18px 16px 60px}
    header{
      position:sticky; top:12px; z-index:10;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 14px;
      border:1px solid var(--stroke);
      border-radius:18px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      backdrop-filter: blur(16px);
      box-shadow: 0 16px 60px rgba(0,0,0,.20);
    }
    .brand{display:flex; align-items:center; gap:12px; min-width:240px}
    .logo{
      width:56px;height:56px;border-radius:16px; overflow:hidden;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      box-shadow: 0 22px 60px rgba(124,58,237,.20);
      position:relative;
    }
    .logo img{width:100%;height:100%;object-fit:cover;transform:scale(1.06)}
    .brand .name{font-weight:900; letter-spacing:.10em; font-size:15px; line-height:1}
    .brand .tag{font-size:12px;color:var(--muted); margin-top:3px}
    .actions{display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end}
    .pill{
      display:flex; align-items:center; gap:10px;
      padding:8px 10px; border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      font-size:12px; color:var(--muted);
    }
    .dot{width:8px;height:8px;border-radius:99px;background:linear-gradient(120deg,var(--a),var(--b))}
    .btn{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.07);
      color:var(--text);
      padding:10px 14px;
      border-radius:999px;
      font-weight:800;
      cursor:pointer;
      transition:.15s ease;
      user-select:none;
    }
    .btn:hover{transform:translateY(-1px); background: rgba(255,255,255,.10)}
    .btn:active{transform:translateY(0)}
    .btn.primary{
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(120deg, rgba(124,58,237,.9), rgba(34,211,238,.55));
      box-shadow: 0 18px 55px rgba(124,58,237,.18);
    }
    .btn.small{padding:8px 12px; font-size:13px}

    .card{
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
      backdrop-filter: blur(16px);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .inner{padding:22px}
    .hero{margin-top:16px; display:grid; grid-template-columns: 1.2fr .8fr; gap:14px}
    @media (max-width:920px){ .hero{grid-template-columns:1fr} .brand{min-width:auto} }
    h1{margin:0 0 10px 0; font-size: clamp(30px, 4vw, 54px); letter-spacing:-.02em; line-height:1.02}
    .sub{margin:0 0 16px 0; color:var(--muted); line-height:1.6; font-size:15px; max-width:65ch}
    .grid{display:grid; grid-template-columns: repeat(3,1fr); gap:12px; margin-top:14px}
    @media (max-width:920px){ .grid{grid-template-columns:1fr} }
    .mini{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      border-radius:18px;
      padding:16px;
      min-height:120px;
    }
    .mini h3{margin:0 0 8px 0; font-size:15px}
    .mini p{margin:0; color:var(--muted); font-size:13px; line-height:1.55}

    .page{display:none}
    .page.active{display:block}

    .field{display:flex; flex-direction:column; gap:6px; margin-top:10px}
    label{font-size:12px; color:rgba(255,255,255,.65)}
    [data-theme="light"] label{color:rgba(0,0,0,.55)}
    input{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      color:var(--text);
      outline:none;
    }
    input::placeholder{color: rgba(255,255,255,.45)}
    [data-theme="light"] input::placeholder{color: rgba(0,0,0,.35)}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    @media (max-width:920px){ .row{grid-template-columns:1fr} }

    .toast{
      margin-top:12px; padding:10px 12px;
      border-radius:14px; border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      color:var(--muted); font-size:13px; display:none;
    }
    .toast.show{display:block}
    .toast.ok{border-color: rgba(34,197,94,.35); color: rgba(34,197,94,.95)}
    .toast.warn{border-color: rgba(245,158,11,.35); color: rgba(245,158,11,.95)}
    .toast.err{border-color: rgba(239,68,68,.35); color: rgba(239,68,68,.95)}

    footer{
      margin-top:18px; padding:18px 4px 0;
      color:rgba(255,255,255,.55); font-size:12px;
      display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }
    [data-theme="light"] footer{color:rgba(0,0,0,.55)}
    footer a{color:inherit; text-decoration:none}
    footer a:hover{text-decoration:underline}
  </style>
</head>

<body>
  <div class="wrap">

    <header>
      <div class="brand">
        <div class="logo"><img src="logo.webp" alt="Pepsval"></div>
        <div>
          <div class="name">PEPSVAL</div>
          <div class="tag">Where Shipping Trust Exists.</div>
        </div>
      </div>

      <div class="actions">
        <div class="pill"><span class="dot"></span><span id="statusText">Early access open</span></div>
        <button class="btn small" id="themeBtn" type="button">üåô Dark</button>
        <button class="btn small primary" id="navLoginBtn" type="button">Login</button>
        <button class="btn small" id="navLogoutBtn" type="button" style="display:none;">Logout</button>
      </div>
    </header>

    <!-- PAGE: LANDING -->
    <section id="landing" class="page active">
      <div class="hero">
        <div class="card">
          <div class="inner">
            <h1>A friendly trust layer for global shipping.</h1>
            <p class="sub">
              Pepsval helps seafarers and companies share verified details in a calm, respectful way.
              Your profile stays private by default ‚Äî you decide what to share and when.
            </p>

            <div style="display:flex;
gap:10px; flex-wrap:wrap;">
              <button class="btn primary" id="landingLoginBtn" type="button">Login / Create account</button>
              <button class="btn" id="landingAboutBtn" type="button">How it works</button>
            </div>

            <div class="grid">
              <div class="mini">
                <h3>For Seafarers</h3>
                <p>Build a trusted profile, keep your key details organized, and share only what you choose.</p>
              </div>
              <div class="mini">
                <h3>For Companies</h3>
                <p>Request confirmations and appraisals respectfully, and shortlist faster with clearer signals.</p>
              </div>
              <div class="mini">
                <h3>For the Industry</h3>
                <p>A single place for trust, connections, and opportunities ‚Äî built for sea & shore careers.</p>
              </div>
            </div>

            <div style="margin-top:14px;padding:14px;border-radius:18px;border:1px solid var(--stroke);background:rgba(255,255,255,.06)">
              <div style="font-weight:900;margin-bottom:6px;">Partnerships</div>
              <div style="color:var(--muted);font-size:13px;line-height:1.5">
                Training institutes, crewing agencies, unions/associations, and ship managers are welcome to collaborate.
                Email: <a href="mailto:jithinilip@gmail.com">jithinilip@gmail.com</a>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="inner">
            <div style="display:flex;justify-content:space-between;gap:10px;align-items:center;">
              <div style="font-weight:900;letter-spacing:.06em;">v1 foundations</div>
              <div style="font-size:12px;color:var(--muted);">simple ‚Ä¢ clear</div>
            </div>

            <div style="height:10px"></div>

            <div class="mini" style="margin-bottom:12px;">
              <h3>Document Verified</h3>
              <p>Key documents can be checked for authenticity and expiry.</p>
            </div>
            <div class="mini" style="margin-bottom:12px;">
              <h3>Employment Confirmed</h3>
              <p>Companies can confirm dates and vessel details with a simple response.</p>
            </div>
            <div class="mini">
              <h3>Peer Confirmed</h3>
              <p>Senior crew can confirm ‚Äúserved together‚Äù ‚Äî optional but powerful.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- PAGE: AUTH -->
    <section id="auth" class="page">
      <div class="card" style="margin-top:16px;">
        <div class="inner">
          <h2 style="margin:0 0 6px 0;">Login</h2>
          <p class="sub" style="margin-top:0">Email + password. Create an account if you are new.</p>

          <div class="row">
            <div class="field">
              <label>Email</label>
              <input id="email" type="email" placeholder="you@example.com" autocomplete="email">
            </div>
            <div class="field">
              <label>Password</label>
              <input id="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
            </div>
          </div>

          <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:14px;">
            <button class="btn primary" id="btnLogin" type="button">Login</button>
            <button class="btn" id="btnSignup" type="button">Create account</button>
            <button class="btn" id="btnBack" type="button">‚Üê Back</button>
          </div>

          <div id="authToast" class="toast"></div>

          <p class="sub" style="margin-top:12px">
            If email confirmation is enabled in Supabase, you must confirm from your inbox once after signup.
          </p>
        </div>
      </div>
    </section>

    <!-- PAGE: ONBOARDING / PROFILE -->
    <section id="profile" class="page">
      <div class="card" style="margin-top:16px;">
        <div class="inner">
          <div style="display:flex;justify-content:space-between;gap:10px;align-items:center;flex-wrap:wrap;">
            <div>
              Signed in as <b id="who">‚Äî</b>
              <div style="font-size:12px;color:var(--muted);margin-top:4px">Create your profile (private by default).</div>
            </div>
            <div style="display:flex; gap:10px; flex-wrap:wrap;">
              <button class="btn" id="btnHome" type="button">Home</button>
              <button class="btn" id="btnLogout" type="button">Logout</button>
            </div>
          </div>

          <div class="row" style="margin-top:12px;">
            <div class="field">
              <label>Full name</label>
              <input id="full_name" type="text" placeholder="Jithin Philip">
            </div>
            <div class="field">
              <label>Nationality</label>
              <input id="nationality" type="text" placeholder="Indian">
            </div>
          </div>

          <div class="row">
            <div class="field">
              <label>Rank</label>
              <input id="rank" type="text" placeholder="Second Officer">
            </div>
            <div class="field">
              <label>Date of birth</label>
              <input id="dob" type="date">
            </div>
          </div>

          <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:14px;">
            <button class="btn primary" id="btnSave" type="button">Save profile</button>
            <button class="btn" id="btnLoad" type="button">Load my profile</button>
          </div>

          <div id="profileToast" class="toast"></div>
        </div>
      </div>
    </section>

    <footer>
      <div>¬© <span id="year"></span> Pepsval</div>
      <div>
        Founder
        <a href="https://www.linkedin.com/in/jithinilip?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" target="_blank" rel="noopener">JITHIN PHILIP</a>
      </div>
    </footer>
  </div>

  <script>
    // --- Supabase ---
    const SUPABASE_URL = "https://czlmeehcxrslgfvqjfsb.supabase.co";
    const SUPABASE_ANON_KEY = "sb_publishable_GgqSqLPMHV7YK0F2ck07sg_2jLMPzeV";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // --- Helpers ---
    const $ = (id) => document.getElementById(id);
    const pages = { landing: $("landing"), auth: $("auth"), profile: $("profile") };

    function showPage(name){
      Object.values(pages).forEach(p => p.classList.remove("active"));
      pages[name].classList.add("active");
      window.scrollTo({top:0, behavior:"smooth"});
    }
    function toast(el, type, msg){
      el.className = "toast show " + (type || "");
      el.textContent = msg;
    }
    function clearToast(el){
      el.className = "toast";
      el.textContent = "";
    }

    // --- Theme ---
    function applyTheme(t){
      document.documentElement.setAttribute("data-theme", t);
      $("themeBtn").textContent = (t === "light") ? "‚òÄÔ∏è Light" : "üåô Dark";
      localStorage.setItem("pepsval_theme", t);
    }
    applyTheme(localStorage.getItem("pepsval_theme") || "dark");
    $("themeBtn").addEventListener("click", () => {
      const cur = document.documentElement.getAttribute("data-theme") || "dark";
      applyTheme(cur === "dark" ? "light" : "dark");
    });

    $("year").textContent = new Date().getFullYear();

    // --- Nav Buttons ---
    $("landingLoginBtn").addEventListener("click", () => showPage("auth"));
    $("navLoginBtn").addEventListener("click", async () => {
      const { data } = await supabase.auth.getSession();
      showPage(data.session ? "profile" : "auth");
    });
    $("navLogoutBtn").addEventListener("click", logout);
    $("btnBack").addEventListener("click", () => showPage("landing"));
    $("btnHome").addEventListener("click", () => showPage("landing"));

    $("landingAboutBtn").addEventListener("click", () => {
      alert(
        "Pepsval is building a private-by-default trust layer for seafarers and companies.\n\n" +
        "Today we focus on:\n" +
        "1) Login\n2) Profile creation\n\n" +
        "Next we can add sea time, documents, and employer confirmations."
      );
    });

    // --- Auth ---
    $("btnSignup").addEventListener("click", signUp);
    $("btnLogin").addEventListener("click", signIn);
    $("btnLogout").addEventListener("click", logout);

    async function signUp(){
      clearToast($("authToast"));
      const email = $("email").value.trim();
      const password = $("password").value;
      if (!email || !password) return toast($("authToast"), "warn", "Enter email and password.");

      const { error } = await supabase.auth.signUp({ email, password });
      if (error) return toast($("authToast"), "err", error.message);

      toast($("authToast"), "ok", "Account created. If confirmation email is enabled, confirm from inbox, then login.");
    }

    async function signIn(){
      clearToast($("authToast"));
      const email = $("email").value.trim();
      const password = $("password").value;
      if (!email || !password) return toast($("authToast"), "warn", "Enter email and password.");

      const { data, error } = await supabase.auth.signInWithPassword({ email, password });
      if (error) return toast($("authToast"), "err", error.message);

      await syncUI();
      showPage("profile");
    }

    async function logout(){
      await supabase.auth.signOut();
      await syncUI();
      showPage("landing");
    }

    // --- Profile ---
    $("btnSave").addEventListener("click", saveProfile);
    $("btnLoad").addEventListener("click", loadProfile);

    async function saveProfile(){
      clearToast($("profileToast"));
      const { data } = await supabase.auth.getSession();
      const session = data.session;
      if (!session) return (showPage("auth"), toast($("authToast"), "warn", "Please login first."));

      const user = session.user;
      const payload = {
        id: user.id,
        full_name: $("full_name").value.trim() || null,
        nationality: $("nationality").value.trim() || null,
        rank: $("rank").value.trim() || null,
        dob: $("dob").value || null,
        updated_at: new Date().toISOString()
      };

      const { error } = await supabase.from("profiles").upsert(payload, { onConflict: "id" });
      if (error) return toast($("profileToast"), "err", "Save failed: " + error.message);

      toast($("profileToast"), "ok", "Profile saved successfully.");
    }

    async function loadProfile(){
      clearToast($("profileToast"));
      const { data } = await supabase.auth.getSession();
      const session = data.session;
      if (!session) return (showPage("auth"), toast($("authToast"), "warn", "Please login first."));

      const user = session.user;
      const { data: row, error } = await supabase
        .from("profiles")
        .select("full_name, nationality, rank, dob")
        .eq("id", user.id)
        .single();

      if (error) return toast($("profileToast"), "err", "Load failed: " + error.message);

      $("full_name").value = row.full_name || "";
      $("nationality").value = row.nationality || "";
      $("rank").value = row.rank || "";
      $("dob").value = row.dob || "";

      toast($("profileToast"), "ok", "Profile loaded.");
    }

    // --- UI sync ---
    async function syncUI(){
      const { data } = await supabase.auth.getSession();
      const session = data.session;

      $("navLoginBtn").style.display = session ? "none" : "inline-flex";
      $("navLogoutBtn").style.display = session ? "inline-flex" : "none";

      $("who").textContent = session ? (session.user.email || session.user.id) : "‚Äî";
      $("statusText").textContent = session ? "Signed in" : "Early access open";
    }

    supabase.auth.onAuthStateChange(() => syncUI());
    syncUI();
  </script>
</body>
</html>